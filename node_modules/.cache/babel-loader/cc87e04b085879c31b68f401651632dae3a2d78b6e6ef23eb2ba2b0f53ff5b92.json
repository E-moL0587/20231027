{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/\\u7AF9\\u5185 \\u6D77\\u6597/workspace/Hackathon/20231027/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/\\u7AF9\\u5185 \\u6D77\\u6597/workspace/Hackathon/20231027/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/\\u7AF9\\u5185 \\u6D77\\u6597/workspace/Hackathon/20231027/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";// アルバム画面\nimport React,{useEffect,useState}from'react';import db from'../firebase';import{collection,getDocs,deleteDoc,updateDoc}from'firebase/firestore';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Album(_ref){var onBack=_ref.onBack;// 初期化\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),edit=_useState4[0],setEdit=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),editTex=_useState6[0],setEditTex=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),snapshot=_useState8[0],setSnapshot=_useState8[1];var Space=function Space(text){return text.replace(/ /g,'');};// データを取得する\nvar AlbumData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var collectionRef,snap,dataArray;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:collectionRef=collection(db,'collection');_context.next=3;return getDocs(collectionRef);case 3:snap=_context.sent;setSnapshot(snap);dataArray=snap.docs.map(function(doc){var _doc$data=doc.data(),field1=_doc$data.field1,field2=_doc$data.field2;return{field1:field1,field2:field2};});setData(dataArray);case 7:case\"end\":return _context.stop();}},_callee);}));return function AlbumData(){return _ref2.apply(this,arguments);};}();useEffect(function(){AlbumData();},[]);// 編集する\nvar hl_Edit=function hl_Edit(index){setEdit(index);setEditTex(data[index].field2);};// 削除する\nvar hl_Delete=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(index){var docToDelete;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:docToDelete=snapshot.docs[index];if(!docToDelete){_context2.next=5;break;}_context2.next=4;return deleteDoc(docToDelete.ref);case 4:AlbumData();case 5:case\"end\":return _context2.stop();}},_callee2);}));return function hl_Delete(_x){return _ref3.apply(this,arguments);};}();// 編集を保存する\nvar hl_SaveEdit=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(index){var docToEdit;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:docToEdit=snapshot.docs[index];_context3.next=3;return updateDoc(docToEdit.ref,{field2:editTex});case 3:setEdit(null);AlbumData();alert('保存されました！');case 6:case\"end\":return _context3.stop();}},_callee3);}));return function hl_SaveEdit(_x2){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u30A2\\u30EB\\u30D0\\u30E0\\u4E00\\u89A7\"}),data.map(function(item,index){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"img\",{src:item.field1,alt:\"Album\",style:{width:'25%'}}),edit===index?/*#__PURE__*/ // 編集モードである場合\n_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editTex,onChange:function onChange(e){return setEditTex(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return hl_SaveEdit(index);},children:\"\\u4FDD\\u5B58\"})]}):/*#__PURE__*/ // 編集モードでない場合\n_jsxs(\"div\",{children:[Space(item.field2).split('\\n').map(function(line,i){return/*#__PURE__*/_jsx(\"div\",{children:line},i);}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return hl_Edit(index);},children:\"\\u7DE8\\u96C6\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return hl_Delete(index);},children:\"\\u524A\\u9664\"})]}),/*#__PURE__*/_jsx(\"br\",{})]},index);}),/*#__PURE__*/_jsx(\"button\",{onClick:onBack,children:\"\\u623B\\u308B\"})]});}export default Album;","map":{"version":3,"names":["React","useEffect","useState","db","collection","getDocs","deleteDoc","updateDoc","jsx","_jsx","jsxs","_jsxs","Album","_ref","onBack","_useState","_useState2","_slicedToArray","data","setData","_useState3","_useState4","edit","setEdit","_useState5","_useState6","editTex","setEditTex","_useState7","_useState8","snapshot","setSnapshot","Space","text","replace","AlbumData","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","collectionRef","snap","dataArray","wrap","_callee$","_context","prev","next","sent","docs","map","doc","_doc$data","field1","field2","stop","apply","arguments","hl_Edit","index","hl_Delete","_ref3","_callee2","docToDelete","_callee2$","_context2","ref","_x","hl_SaveEdit","_ref4","_callee3","docToEdit","_callee3$","_context3","alert","_x2","children","item","src","alt","style","width","type","value","onChange","e","target","onClick","split","line","i"],"sources":["C:/Users/竹内 海斗/workspace/Hackathon/20231027/src/components/2-2_Album.jsx"],"sourcesContent":["// アルバム画面\r\nimport React, { useEffect, useState } from 'react';\r\nimport db from '../firebase';\r\nimport { collection, getDocs, deleteDoc, updateDoc } from 'firebase/firestore';\r\n\r\nfunction Album({ onBack }) {\r\n\r\n  // 初期化\r\n  const [data, setData] = useState([]);\r\n  const [edit, setEdit] = useState(null);\r\n  const [editTex, setEditTex] = useState('');\r\n  const [snapshot, setSnapshot] = useState(null);\r\n  const Space = (text) => { return text.replace(/ /g, ''); };\r\n\r\n  // データを取得する\r\n  const AlbumData = async () => {\r\n    const collectionRef = collection(db, 'collection');\r\n    const snap = await getDocs(collectionRef);\r\n    setSnapshot(snap);\r\n    const dataArray = snap.docs.map((doc) => {\r\n      const { field1, field2 } = doc.data();\r\n      return { field1, field2 };\r\n    });\r\n    setData(dataArray);\r\n  };\r\n\r\n  useEffect(() => { AlbumData(); }, []);\r\n\r\n  // 編集する\r\n  const hl_Edit = (index) => { setEdit(index); setEditTex(data[index].field2); };\r\n\r\n  // 削除する\r\n  const hl_Delete = async (index) => {\r\n    const docToDelete = snapshot.docs[index];\r\n    if (docToDelete) { await deleteDoc(docToDelete.ref); AlbumData(); }\r\n  };\r\n\r\n  // 編集を保存する\r\n  const hl_SaveEdit = async (index) => {\r\n    const docToEdit = snapshot.docs[index];\r\n    await updateDoc(docToEdit.ref, { field2: editTex });\r\n    setEdit(null); AlbumData(); alert('保存されました！');\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>アルバム一覧</h2>\r\n      {data.map((item, index) => (<div key={index}>\r\n          <img src={item.field1} alt=\"Album\" style={{ width: '25%' }} />\r\n\r\n          {edit === index ? (\r\n            // 編集モードである場合\r\n            <div>\r\n              <input type=\"text\" value={editTex} onChange={(e) => setEditTex(e.target.value)} />\r\n              <button onClick={() => hl_SaveEdit(index)}>保存</button>\r\n            </div>\r\n          ) : (\r\n            // 編集モードでない場合\r\n            <div>\r\n              {Space(item.field2).split('\\n').map((line, i) => (<div key={i}>{line}</div>))}<br/>\r\n              <button onClick={() => hl_Edit(index)}>編集</button>\r\n              <button onClick={() => hl_Delete(index)}>削除</button>\r\n            </div>\r\n          )}<br />\r\n\r\n      </div>))}\r\n      <button onClick={onBack}>戻る</button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Album;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}